(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a(68)},27:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(11),r=a.n(s),c=(a(27),a(15)),l=a(16),o=a(17),d=a(19),h=a(18),u=a(20),v=a(3),m=a(4),b=function(e){var t=e.binary,a=e.card,s=e.facility,r=t.split(""),c=t.lastIndexOf(a),l=t.lastIndexOf(s);return c>=0&&r.splice(c,a.length,a),l>=0&&r.splice(l,s.length,s),i.a.createElement(n.Fragment,null,r.map(function(e,t){return i.a.createElement("span",{style:e===s?{backgroundColor:"lightgreen"}:e===a?{backgroundColor:"yellow"}:null,key:t},e)}))},f={getPorts:function(){return navigator.usb.getDevices().then(function(e){return e.map(function(e){return new f.Port(e)})})},requestPort:function(){return navigator.usb.requestDevice({filters:[{vendorId:6991}]}).then(function(e){return new f.Port(e)}).catch(function(e){return console.log(e)})},Port:function(e){this.device_=e}};f.Port.prototype.connect=function(){var e=this;return this.device_.open().then(function(){if(null===e.device_.configuration)return e.device_.selectConfiguration(1)}).then(function(){return e.device_.claimInterface(2)}).then(function(){return e.device_.selectAlternateInterface(2,0)}).then(function(){return e.device_.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:2})}).then(function(){!function t(){e.device_.transferIn(5,64).then(function(a){e.onReceive(a.data),t()},function(t){e.onReceiveError(t)})}()})},f.Port.prototype.disconnect=function(){var e=this;return this.device_.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:0,index:2}).then(function(){return e.device_.close()})},f.Port.prototype.send=function(e){return this.device_.transferOut(4,e)};var p,g=f,y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={inputHex:"",dispHex:"",orderedHex:"",bits:"",binary:"",dispBinary:"",decodeBinary:[],decodeLength:0,cardNumber:"",cardBits:"",cardStart:0,cardLength:0,cardChunk:"",facilityChunk:"",facilityStart:0,facilityLength:0,facilityCode:"",facilityBits:"",showDecode:!1,showSettings:!1,reverse:!0},a.handleUserInput=a.handleUserInput.bind(Object(v.a)(Object(v.a)(a))),a.handleCardNumber=a.handleCardNumber.bind(Object(v.a)(Object(v.a)(a))),a.handleFacilityCode=a.handleFacilityCode.bind(Object(v.a)(Object(v.a)(a))),a.handleHex=a.handleHex.bind(Object(v.a)(Object(v.a)(a))),a.handleBits=a.handleBits.bind(Object(v.a)(Object(v.a)(a))),a.handleDecodeBits=a.handleDecodeBits.bind(Object(v.a)(Object(v.a)(a))),a.handleReverse=a.handleReverse.bind(Object(v.a)(Object(v.a)(a))),a.handleSettings=a.handleSettings.bind(Object(v.a)(Object(v.a)(a))),a.handleShowSettings=a.handleShowSettings.bind(Object(v.a)(Object(v.a)(a))),a.connectButton=a.connectButton.bind(Object(v.a)(Object(v.a)(a))),a.connectUSB=a.connectUSB.bind(Object(v.a)(Object(v.a)(a))),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"connectButton",value:function(){var e=this;p?(p.disconnect(),p=null,this.setState({connected:!1,reverse:!0})):g.requestPort().then(function(t){p=t,e.connectUSB(),e.setState({connected:!0,reverse:!1})}).catch(function(t){e.setState({connected:!1}),window.Materialize.toast("No USB device selected.",5e3)})}},{key:"connectUSB",value:function(){var e=this;p.connect().then(function(){p.onReceive=function(t){var a=(new TextDecoder).decode(t);a=JSON.parse(a),e.setState({readerBits:a.bits,readerHex:a.hex}),e.handleHex(a.hex),e.handleBits(a.bits)},p.onReceiveError=function(e){window.Materialize.toast(e,5e3)}},function(e){window.Materialize.toast(e,5e3)})}},{key:"handleUserInput",value:function(e){switch(e.target.id){case"HEX":this.handleHex(e.target.value);break;case"BITS":this.handleBits(e.target.value);break;case"CARD":this.handleCardNumber(e.target.value);break;case"FACILITY":this.handleFacilityCode(e.target.value);break;case"SITESTART":this.handleSettings({key:"facilityStart",value:e.target.value});break;case"SITELENGTH":this.handleSettings({key:"facilityLength",value:e.target.value});break;case"CARDSTART":this.handleSettings({key:"cardStart",value:e.target.value});break;case"CARDLENGTH":this.handleSettings({key:"cardLength",value:e.target.value})}}},{key:"handleSettings",value:function(e){var t=this;this.setState(Object(c.a)({},e.key,parseInt(e.value,10)),function(){return t.handleDecodeBits()})}},{key:"handleDecodeBits",value:function(){if(this.state.showSettings){var e="*".repeat(this.state.bits);e=e.split("");var t="F".repeat(this.state.facilityLength),a="C".repeat(this.state.cardLength);this.state.cardLength>0&&e.splice(this.state.cardStart,this.state.cardLength,a),this.state.facilityLength>0&&e.splice(this.state.facilityStart,this.state.facilityLength,t);var n=this.state.dispBinary.slice(this.state.facilityStart,this.state.facilityStart+this.state.facilityLength),i=this.state.dispBinary.slice(this.state.cardStart,this.state.cardStart+this.state.cardLength),s=e.join("").length,r=parseInt(i,2)||0,c=parseInt(n,2)||0;this.setState({decodeBinary:e,decodeLength:s,cardBits:i,facilityBits:n,cardNumber:r,facilityCode:c,facilityChunk:t,cardChunk:a})}}},{key:"handleShowSettings",value:function(){var e=this;this.setState({showSettings:!this.state.showSettings,facilityCode:"",cardNumber:"",facilityStart:0,facilityLength:0,cardStart:0,cardLength:0},function(){e.handleCardNumber(),e.handleFacilityCode(),e.handleDecodeBits()})}},{key:"handleReverse",value:function(){var e=this;this.setState({reverse:!this.state.reverse},function(){return e.handleHex(e.state.inputHex)})}},{key:"handleCardNumber",value:function(e){var t=parseInt(e,10).toString(2);this.setState({cardNumber:e,cardBits:t})}},{key:"handleFacilityCode",value:function(e){var t=parseInt(e,10).toString(2);this.setState({facilityCode:e,facilityBits:t})}},{key:"handleBits",value:function(e){var t=this,a=this.state.binary.length-e,n=this.state.binary.slice(a);this.setState({bits:e,dispBinary:n},function(){return t.handleDecodeBits()})}},{key:"handleHex",value:function(e){var t,a=this,n=e.toUpperCase(),i=n.match(/[0-9a-f]{2}/gi)||"";if(i.length>0){t=this.state.reverse?i.slice().reverse():i;var s=i.reduce(function(e,t){return e=e+" "+t},""),r=t.reduce(function(e,t){e.hex=e.hex+" "+t;var a=parseInt(t,16).toString(2);return a="00000000".substr(a.length)+a,e.bin=e.bin+a,e},{hex:"",bin:""}),c=r.bin.length-this.state.bits||0,l=r.bin.slice(c);this.setState({inputHex:n,dispHex:s,orderedHex:r.hex,binary:r.bin,dispBinary:l,showDecode:!0},function(){return a.handleDecodeBits()})}else this.setState({inputHex:n,showDecode:!1})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(m.Card,{title:"Card Decoder Tool",className:"decoder"},i.a.createElement(m.Row,null,i.a.createElement(m.Input,{s:4,name:"group1",type:"checkbox",value:"reverse",label:"Reverse Raw Hex",checked:this.state.reverse,disabled:this.state.connected,onClick:this.handleReverse}),i.a.createElement(m.Input,{s:4,onClick:this.connectButton,name:"group1",type:"checkbox",value:"connected",label:"Connect USB Reader",checked:this.state.connected}),i.a.createElement(m.Input,{s:4,name:"group1",type:"checkbox",value:"settings",label:"Show Reader Settings",checked:this.state.showSettings,onClick:this.handleShowSettings})),i.a.createElement(m.Row,null,this.state.connected?i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"col s5"},i.a.createElement("label",{className:"active",htmlFor:"inputHex"},"Raw Hex Value"),i.a.createElement("p",{id:"inputHex"},this.state.inputHex)),i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active",htmlFor:"inputBits"},"Card Bits"),i.a.createElement("p",{id:"inputBits"},this.state.bits))):i.a.createElement(n.Fragment,null,i.a.createElement(m.Input,{id:"HEX",onChange:this.handleUserInput,s:5,label:"Raw Hex Value",value:this.state.inputHex}),i.a.createElement(m.Input,{id:"BITS",onChange:this.handleUserInput,s:2,label:"Card Bits",value:this.state.bits})),i.a.createElement(m.Col,{s:1}),this.state.showSettings?i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active"},"Facility Code"),i.a.createElement("p",null,this.state.facilityCode)),i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active"},"Card Number"),i.a.createElement("p",null,this.state.cardNumber))):i.a.createElement(n.Fragment,null,i.a.createElement(m.Input,{id:"FACILITY",onChange:this.handleUserInput,s:2,label:"Facility Code",value:this.state.facilityCode}),i.a.createElement(m.Input,{id:"CARD",onChange:this.handleUserInput,s:2,label:"Card Number",value:this.state.cardNumber}))),i.a.createElement(m.Row,{style:this.state.showDecode?null:{display:"none"}},i.a.createElement("div",{className:"col s6"},i.a.createElement("label",{className:"active",htmlFor:"parsedHex"},"Parsed Hex"),i.a.createElement("p",{id:"parsedHex"},this.state.dispHex)),i.a.createElement("div",{style:this.state.reverse?null:{display:"none"},className:"col s6"},i.a.createElement("label",{className:"active",htmlFor:"reverseHex"},"Reversed Hex"),i.a.createElement("p",{id:"reverseHex"},this.state.orderedHex)),i.a.createElement("div",{className:"col s12 divider",style:{margin:"5px"}}),i.a.createElement("div",{className:"col s12"},i.a.createElement("label",{htmlFor:"bits"},"Binary"),i.a.createElement("p",{className:"binary"},i.a.createElement(b,{binary:this.state.dispBinary,card:this.state.cardBits,facility:this.state.facilityBits}))),i.a.createElement("div",{style:this.state.showSettings?this.state.decodeLength>this.state.bits?{color:"red",fontWeight:"bold"}:null:{display:"none"},className:"col s12 binary"},this.state.decodeBinary.map(function(t,a){return i.a.createElement("span",{style:t===e.state.facilityChunk?{backgroundColor:"lightgreen"}:t===e.state.cardChunk?{backgroundColor:"yellow"}:null,key:a},t)})),i.a.createElement("div",{className:"col s12 divider"})),i.a.createElement(m.Row,{style:this.state.showSettings?null:{display:"none"}},i.a.createElement(m.Col,{s:1}),i.a.createElement("div",{style:{paddingTop:"15px"},className:"col s1"},"Facility Code"),i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active"},"Start Bit"),i.a.createElement("input",{id:"SITESTART",onChange:this.handleUserInput,value:this.state.facilityStart,min:"0",type:"number"})),i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active"},"Number of Bits"),i.a.createElement("input",{id:"SITELENGTH",onChange:this.handleUserInput,value:this.state.facilityLength,min:"0",type:"number"})),i.a.createElement("div",{style:{paddingTop:"15px"},className:"col s1"},"Card Number"),i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active"},"Start Bit"),i.a.createElement("input",{id:"CARDSTART",onChange:this.handleUserInput,value:this.state.cardStart,min:"0",type:"number"})),i.a.createElement("div",{className:"col s2"},i.a.createElement("label",{className:"active"},"Number of Bits"),i.a.createElement("input",{id:"CARDLENGTH",onChange:this.handleUserInput,value:this.state.cardLength,min:"0",type:"number"})),i.a.createElement("div",{className:"col s12 divider"}))))}}]),t}(n.Component),S=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(i.a.createElement(y,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/USB_Card_Reader",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/USB_Card_Reader","/service-worker.js");S?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):E(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):E(t,e)})}}()}},[[21,1,2]]]);
//# sourceMappingURL=main.8487c86f.chunk.js.map